<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Chat :: SIGER</title>
    <link rel="stylesheet" href="/styles/global.css">
    <link rel="stylesheet" href="/styles/chat.css">
    <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">
</head>
<body>

    <div class="blue-header">...</div>

    <div class="chat-window-container">
        <div class="chat-window">
            <div class="contacts-side">
                <div class="search-widget">
                    <div class="search-bar">
                        <i class="material-icons">search</i>
                        <input id="searchUserInputView" type="text" placeholder="Buscar usuario en el SIGER...">
                    </div>
                </div>
                <div id="searchResultsContainer" class="contacts-list prevent-selection hidden-container">

                </div>
                <div id="conversationsListView" class="contacts-list prevent-selection">

                </div>
            </div>
            <div id="noOpenConversationView" class="no-open-conversation-container">
                <i class="material-icons">chat</i>
                <h3>Seleccione una conversación en el panel de la izquierda para abrirla.</h3>
                <br>
                <h3>También puede usar el buscador para comenzar una nueva conversación con otro usuario del SIGER</h3>
            </div>
            <div id="messagesSideView" class="messages-side hidden-container">
                <div class="top-bar prevent-selection">
                    <p id="contactNameView" class="name">

                    </p>
                    <div class="options">
                        <i onclick="copyEmail();" class="material-icons" title="Copiar correo electrónico al portapapeles">email</i>
                        <input style="position: absolute; left: -5000em;" id="emailInputView" value="..." type="text">
                    </div>
                </div>
                <div class="chat">
                    <div id="messagesContainer" class="messages-container">

                    </div>
                    <script>
                        const messages = Array.from(document.getElementsByClassName('message')).filter(m => m.parentNode.id == 'messagesContainer');
                        const messagesContainer = document.getElementById('messagesContainer');
                    </script>
                    <div class="writer-container">
                        <div id="attachedFilesContainer" class="attachedFiles hidden-container">
                            <p class="title">Archivos anexados:</p>
                            <div id="attachedFilesListView" class="list">
                                <div class="file">
                                    <i class="material-icons">close</i>
                                    <p class="name">p6.5.pdf</p>
                                </div>
                                <div class="file">
                                    <i class="material-icons">close</i>
                                    <p class="name">p6.5.pdf</p>
                                </div>
                                <div class="file">
                                    <i class="material-icons">close</i>
                                    <p class="name">p6.5.pdf</p>
                                </div>
                                <div class="file">
                                    <i class="material-icons">close</i>
                                    <p class="name">p6.5.pdf</p>
                                </div>
                            </div>
                        </div>
                        <div class="writer">
                            <i onclick="openFilePicker();" class="material-icons" title="Anexar un archivo">attach_file</i>
                            <input id="fileInput" type="file" hidden multiple>
                            <textarea id="messageView" rows="1" type="text" placeholder="Mensaje..."></textarea>
                            <i onclick="sendMessage();" class="primary material-icons" title="Enviar mensaje">send</i>
                            <script>
                                const messageView = document.getElementById('messageView');
                                messageView.oninput = (e) => {
                                    // Altura de textarea dinámica.
                                    const lines = messageView.value.split('\n').length;
                                    const maxLines = 5;
                                    messageView.rows = lines <= maxLines ? lines : maxLines;
                                }

                                messageView.onkeydown = (e) => {
                                    // Mensajes se envían con presionar Enter (keyCode = 13).
                                    // Para un salto de línea, hay que presionar Shift+Enter.
                                    if (e.keyCode == 13 && !e.shiftKey) {
                                        e.preventDefault();
                                        sendMessage();
                                    }
                                }
                            </script>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script src="/scripts/menu.js"></script>
    <script src="/chat-pages/chat.js"></script>
</body>
</html>